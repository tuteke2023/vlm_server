<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLM Server - Document Intelligence Platform</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <h1>VLM Server</h1>
                    <span class="subtitle">Document Intelligence Platform</span>
                </div>
                <div class="nav-links">
                    <a href="index.html" class="nav-link active">
                        <i class="fas fa-tools"></i> Processing Tools
                    </a>
                    <a href="chat.html" class="nav-link">
                        <i class="fas fa-comments"></i> Chat
                    </a>
                </div>
                <div class="server-status">
                    <div class="status-indicator" id="serverStatus">
                        <span class="status-dot"></span>
                        <span class="status-text">Connecting...</span>
                    </div>
                    <div class="vram-usage" id="vramUsage">
                        <i class="fas fa-microchip"></i>
                        <span>VRAM: --</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav-menu">
                    <h3>Processing Tools</h3>
                    <ul class="menu-items">
                        <li class="menu-item active" data-tool="bank-transactions">
                            <i class="fas fa-credit-card"></i>
                            <span>Bank Transactions</span>
                        </li>
                        <li class="menu-item" data-tool="document-summary">
                            <i class="fas fa-file-alt"></i>
                            <span>Document Summary</span>
                        </li>
                        <li class="menu-item" data-tool="image-analysis">
                            <i class="fas fa-image"></i>
                            <span>Image Analysis</span>
                        </li>
                        <li class="menu-item" data-tool="text-extraction">
                            <i class="fas fa-text-width"></i>
                            <span>Text Extraction</span>
                        </li>
                        <li class="menu-item" data-tool="custom-query">
                            <i class="fas fa-question-circle"></i>
                            <span>Custom Query</span>
                        </li>
                    </ul>
                </nav>

                <!-- VRAM & Model Settings -->
                <div class="model-settings">
                    <h3>Model Settings</h3>
                    
                    <!-- VRAM Status Display -->
                    <div class="vram-status-panel">
                        <div class="status-header">
                            <i class="fas fa-microchip"></i>
                            <span>VRAM Status</span>
                        </div>
                        <div class="vram-info">
                            <div class="vram-bar">
                                <div class="vram-fill" id="vramBar"></div>
                                <div class="vram-text" id="vramText">--</div>
                            </div>
                            <div class="vram-details">
                                <span id="vramDetails">Loading...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Model Selection -->
                    <div class="model-panel">
                        <div class="panel-header">
                            <label for="modelSelect">Model:</label>
                            <select id="modelSelect">
                                <option value="Qwen/Qwen2.5-VL-7B-Instruct">7B-Instruct (High Quality)</option>
                                <option value="Qwen/Qwen2.5-VL-3B-Instruct">3B-Instruct (Lower VRAM)</option>
                            </select>
                        </div>
                        <div class="model-info" id="modelInfo">
                            <small>Current: Loading...</small>
                        </div>
                    </div>
                    
                    <!-- Model Actions -->
                    <div class="model-actions-panel">
                        <button class="action-btn" id="reloadModelBtn">
                            <i class="fas fa-sync-alt"></i>
                            Switch Model
                        </button>
                        <div class="action-info">
                            <small>Switch between models for different VRAM usage</small>
                        </div>
                    </div>
                    
                    <!-- Quantization Controls (Hidden - Not Working) -->
                    <div class="quantization-panel" style="display: none;">
                        <div class="panel-header">
                            <label for="quantizationSelect">Quantization:</label>
                            <select id="quantizationSelect">
                                <option value="none">None (Full Precision)</option>
                                <option value="8bit">8-bit (Memory Optimization)</option>
                                <option value="4bit">4-bit (Aggressive Optimization)</option>
                            </select>
                        </div>
                        <div class="quantization-info" id="quantizationInfo">
                            <small>Current: No quantization active</small>
                        </div>
                    </div>
                    
                    <!-- Safety Settings -->
                    <div class="safety-panel">
                        <div class="safety-header">
                            <i class="fas fa-shield-alt"></i>
                            <span>Safety Settings</span>
                        </div>
                        <label class="option-item">
                            <input type="checkbox" id="enableSafetyCheck" checked>
                            <span>VRAM Safety Check</span>
                        </label>
                        <div class="safety-info">
                            <small>Prevents processing if VRAM would exceed 90%</small>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3>Quick Actions</h3>
                    <button class="action-btn" id="clearVramBtn">
                        <i class="fas fa-broom"></i>
                        Clear VRAM
                    </button>
                    <button class="action-btn" id="exportResultsBtn">
                        <i class="fas fa-download"></i>
                        Export Results
                    </button>
                </div>
            </aside>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Tool: Bank Transactions -->
                <div class="tool-panel active" id="bank-transactions">
                    <div class="panel-header">
                        <h2><i class="fas fa-credit-card"></i> Bank Transaction Extraction</h2>
                        <p>Upload bank statements (PDF or images) to extract transaction data</p>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="bankUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h3>Drop files here or click to browse</h3>
                                <p>Supports PDF, PNG, JPG, JPEG files</p>
                                <input type="file" id="bankFileInput" accept=".pdf,.png,.jpg,.jpeg" multiple hidden>
                            </div>
                        </div>
                        
                        <div class="processing-options">
                            <h4>Extraction Options</h4>
                            <div class="options-grid">
                                <label class="option-item">
                                    <input type="checkbox" id="extractDates" checked>
                                    <span>Transaction Dates</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="extractAmounts" checked>
                                    <span>Amounts</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="extractDescriptions" checked>
                                    <span>Descriptions</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="extractBalances" checked>
                                    <span>Running Balances</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="categorizeTransactions">
                                    <span>Categorize Transactions</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="detectMerchants">
                                    <span>Detect Merchants</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tool: Document Summary -->
                <div class="tool-panel" id="document-summary">
                    <div class="panel-header">
                        <h2><i class="fas fa-file-alt"></i> Document Summarization</h2>
                        <p>Upload documents to get AI-powered summaries and insights</p>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="docUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-file-upload"></i>
                                <h3>Drop documents here or click to browse</h3>
                                <p>Supports PDF, images, and text documents</p>
                                <input type="file" id="docFileInput" accept=".pdf,.png,.jpg,.jpeg,.txt" multiple hidden>
                            </div>
                        </div>
                        
                        <div class="processing-options">
                            <h4>Summary Options</h4>
                            <div class="summary-controls">
                                <div class="control-group">
                                    <label for="summaryLength">Summary Length:</label>
                                    <select id="summaryLength">
                                        <option value="brief">Brief (1-2 sentences)</option>
                                        <option value="medium" selected>Medium (1 paragraph)</option>
                                        <option value="detailed">Detailed (Multiple paragraphs)</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label for="summaryStyle">Style:</label>
                                    <select id="summaryStyle">
                                        <option value="executive">Executive Summary</option>
                                        <option value="technical">Technical Summary</option>
                                        <option value="simple" selected>Simple Language</option>
                                        <option value="bullet">Bullet Points</option>
                                    </select>
                                </div>
                                <label class="option-item">
                                    <input type="checkbox" id="extractKeyPoints" checked>
                                    <span>Extract Key Points</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="identifyEntities">
                                    <span>Identify Named Entities</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tool: Image Analysis -->
                <div class="tool-panel" id="image-analysis">
                    <div class="panel-header">
                        <h2><i class="fas fa-image"></i> Image Analysis</h2>
                        <p>Analyze images with detailed descriptions and insights</p>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="imageUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-images"></i>
                                <h3>Drop images here or click to browse</h3>
                                <p>Supports PNG, JPG, JPEG, GIF files</p>
                                <input type="file" id="imageFileInput" accept=".png,.jpg,.jpeg,.gif" multiple hidden>
                            </div>
                        </div>
                        
                        <div class="processing-options">
                            <h4>Analysis Options</h4>
                            <div class="options-grid">
                                <label class="option-item">
                                    <input type="checkbox" id="describeImage" checked>
                                    <span>Detailed Description</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="identifyObjects" checked>
                                    <span>Object Detection</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="readText">
                                    <span>Read Text (OCR)</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="analyzeColors">
                                    <span>Color Analysis</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="detectFaces">
                                    <span>Face Detection</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="identifyLandmarks">
                                    <span>Landmark Recognition</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tool: Text Extraction -->
                <div class="tool-panel" id="text-extraction">
                    <div class="panel-header">
                        <h2><i class="fas fa-text-width"></i> Text Extraction (OCR)</h2>
                        <p>Extract and format text from images and documents</p>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="textUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-file-text"></i>
                                <h3>Drop files here or click to browse</h3>
                                <p>Extract text from images and scanned documents</p>
                                <input type="file" id="textFileInput" accept=".pdf,.png,.jpg,.jpeg" multiple hidden>
                            </div>
                        </div>
                        
                        <div class="processing-options">
                            <h4>Extraction Options</h4>
                            <div class="options-grid">
                                <label class="option-item">
                                    <input type="checkbox" id="preserveFormatting" checked>
                                    <span>Preserve Formatting</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="detectTables">
                                    <span>Detect Tables</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="extractHeaders">
                                    <span>Extract Headers</span>
                                </label>
                                <label class="option-item">
                                    <input type="checkbox" id="cleanText">
                                    <span>Clean & Format Text</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tool: Custom Query -->
                <div class="tool-panel" id="custom-query">
                    <div class="panel-header">
                        <h2><i class="fas fa-question-circle"></i> Custom Query</h2>
                        <p>Ask specific questions about uploaded documents or images</p>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="customUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-upload"></i>
                                <h3>Drop files here or click to browse</h3>
                                <p>Upload any supported file type</p>
                                <input type="file" id="customFileInput" accept=".pdf,.png,.jpg,.jpeg,.txt" multiple hidden>
                            </div>
                        </div>
                        
                        <div class="query-section">
                            <h4>Your Question</h4>
                            <textarea 
                                id="customQuery" 
                                placeholder="Ask anything about the uploaded files... For example:
- What are the main topics discussed in this document?
- How much did I spend on groceries last month?
- What is the total amount of all transactions?
- Describe what's happening in this image
- Extract all phone numbers and email addresses"></textarea>
                            <div class="query-examples">
                                <h5>Example Queries:</h5>
                                <div class="example-tags">
                                    <span class="example-tag" data-query="What are the key financial metrics mentioned in this document?">Financial Analysis</span>
                                    <span class="example-tag" data-query="Summarize the main points in bullet format">Quick Summary</span>
                                    <span class="example-tag" data-query="Extract all dates, amounts, and transaction descriptions in table format">Data Extraction</span>
                                    <span class="example-tag" data-query="What is the sentiment or tone of this document?">Sentiment Analysis</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Processing Section -->
                <div class="processing-section">
                    <button class="process-btn" id="processBtn">
                        <i class="fas fa-play"></i>
                        <span>Start Processing</span>
                    </button>
                    
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">Processing...</div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="results-section" id="resultsSection" style="display: none;">
                    <div class="results-header">
                        <h3>Results</h3>
                        <div class="results-actions">
                            <button class="result-action-btn" id="copyResultBtn">
                                <i class="fas fa-copy"></i>
                                Copy
                            </button>
                            <button class="result-action-btn" id="downloadResultBtn">
                                <i class="fas fa-download"></i>
                                Download
                            </button>
                            <button class="result-action-btn" id="shareResultBtn">
                                <i class="fas fa-share"></i>
                                Share
                            </button>
                        </div>
                    </div>
                    
                    <div class="results-content" id="resultsContent">
                        <!-- Results will be populated here -->
                    </div>
                    
                    <div class="processing-info">
                        <div class="info-item">
                            <span class="info-label">Processing Time:</span>
                            <span class="info-value" id="processingTime">--</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Tokens Used:</span>
                            <span class="info-value" id="tokensUsed">--</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Model:</span>
                            <span class="info-value" id="currentModelDisplay">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div class="toast-container" id="toastContainer"></div>
    </div>

    <script src="static/js/app.js"></script>
</body>
</html>